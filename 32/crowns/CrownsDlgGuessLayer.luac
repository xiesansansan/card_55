slot0 = class("CrownsDlgGuessLayer", require("common.BaseLayer"), function ()
	return UIWrap.newRootLayer({
		fullScreen = false,
		color = cc.c4b(0, 0, 0, 150)
	})
end)
slot0.uiTree = {
	{
		name = "untitled1",
		cType = "MsgBoxBg",
		params = {
			image = "tc_2.png",
			posApt = 1,
			pos = {
				x = 568,
				y = 320
			},
			size = {
				width = 590,
				height = 556
			},
			titleText = TR("下 注")
		},
		children = {
			{
				name = "mTimeLabel",
				cType = "Label",
				params = {
					fontSize = 18,
					emptyInit = true,
					isRichText = true,
					color = {
						g = 37,
						r = 37,
						b = 37
					},
					pos = {
						x = 295,
						y = 492.61
					},
					text = TR("竞猜时间")
				},
				children = {}
			},
			{
				name = "untitled4",
				cType = "Scale9Sprite",
				params = {
					image = "c_92.png",
					pos = {
						x = 295,
						y = 330
					},
					size = {
						width = 525,
						height = 290
					}
				},
				children = {}
			},
			{
				name = "oddsLabel1",
				cType = "Label",
				params = {
					fontSize = 20,
					isRichText = true,
					outlineColor = {
						g = 37,
						r = 37,
						b = 37
					},
					pos = {
						x = 125,
						y = 450
					},
					text = TR("赔率")
				},
				children = {}
			},
			{
				name = "oddsLabel2",
				cType = "Label",
				params = {
					fontSize = 20,
					isRichText = true,
					outlineColor = {
						g = 37,
						r = 37,
						b = 37
					},
					pos = {
						x = 463,
						y = 450
					},
					text = TR("赔率")
				},
				children = {}
			},
			{
				name = "playerNameLabel1",
				cType = "Label",
				params = {
					fontSize = 18,
					color = {
						g = 37,
						r = 37,
						b = 37
					},
					pos = {
						x = 125,
						y = 415
					},
					text = TR("玩家名字")
				},
				children = {}
			},
			{
				name = "playerNameLabel2",
				cType = "Label",
				params = {
					fontSize = 18,
					color = {
						g = 37,
						r = 37,
						b = 37
					},
					pos = {
						x = 463,
						y = 415
					},
					text = TR("玩家名字")
				},
				children = {}
			},
			{
				name = "palyerNode1",
				cType = "PlayerHeroNode",
				params = {
					modelId = 19010000,
					allowClick = false,
					pos = {
						x = 125,
						y = 350
					}
				},
				children = {
					{
						name = "untitled22",
						cType = "Sprite",
						params = {
							hide = true,
							image = "c_17.png",
							childName = "emptyNode",
							anchor = {
								x = 0,
								y = 0
							},
							pos = {
								x = 0,
								y = 0
							}
						},
						children = {
							{
								name = "untitled24",
								cType = "Label",
								params = {
									pos = {
										x = 40.21,
										y = 40.21
									},
									text = TR("轮空")
								},
								children = {}
							}
						}
					}
				}
			},
			{
				name = "palyerNode2",
				cType = "PlayerHeroNode",
				params = {
					modelId = 19010000,
					allowClick = false,
					pos = {
						x = 463,
						y = 350
					}
				},
				children = {
					{
						name = "untitled23",
						cType = "Sprite",
						params = {
							hide = true,
							image = "c_17.png",
							childName = "emptyNode",
							anchor = {
								x = 0,
								y = 0
							},
							pos = {
								x = 0,
								y = 0
							}
						},
						children = {
							{
								name = "untitled25",
								cType = "Label",
								params = {
									pos = {
										x = 40.21,
										y = 40.21
									},
									text = TR("轮空")
								},
								children = {}
							}
						}
					}
				}
			},
			{
				name = "untitled11",
				cType = "Sprite",
				params = {
					scale = 0.6,
					image = "c_82.png",
					pos = {
						x = 133,
						y = 270
					}
				},
				children = {
					{
						name = "fapLabel1",
						cType = "Label",
						params = {
							charCount = 12,
							fontName = "c_81.png",
							anchor = {
								x = 0,
								y = 0.5
							},
							pos = {
								x = 103.38,
								y = 38.87
							},
							text = TR("200万")
						},
						children = {}
					},
					{
						name = "untitled26",
						cType = "Sprite",
						params = {
							image = "c_80.png",
							pos = {
								x = 62.27,
								y = 40
							}
						},
						children = {}
					}
				}
			},
			{
				name = "untitled12",
				cType = "Sprite",
				params = {
					scale = 0.6,
					image = "c_82.png",
					pos = {
						x = 471,
						y = 270
					}
				},
				children = {
					{
						name = "fapLabel2",
						cType = "Label",
						params = {
							charCount = 12,
							fontName = "c_81.png",
							anchor = {
								x = 0,
								y = 0.5
							},
							pos = {
								x = 98.65,
								y = 39.9
							},
							text = TR("200万")
						},
						children = {}
					},
					{
						name = "untitled27",
						cType = "Sprite",
						params = {
							image = "c_80.png",
							pos = {
								x = 62.27,
								y = 40
							}
						},
						children = {}
					}
				}
			},
			{
				name = "checkBox1",
				cType = "Checkbox",
				custom = {
					{
						value = 1,
						name = "tag",
						type = "integer"
					}
				},
				params = {
					normalImage = "c_43.png",
					selectImage = "c_44.png",
					callback = "onCheckCallBack",
					pos = {
						x = 125,
						y = 215
					}
				},
				children = {}
			},
			{
				name = "checkBox2",
				cType = "Checkbox",
				custom = {
					{
						value = 2,
						name = "tag",
						type = "integer"
					}
				},
				params = {
					normalImage = "c_43.png",
					selectImage = "c_44.png",
					callback = "onCheckCallBack",
					pos = {
						x = 463,
						y = 215
					}
				},
				children = {}
			},
			{
				name = "resLabel",
				cType = "Label",
				params = {
					isRichText = true,
					color = {
						g = 37,
						r = 37,
						b = 37
					},
					pos = {
						x = 295,
						y = 160
					},
					text = TR("元宝")
				},
				children = {}
			},
			{
				name = "btnGuess",
				cType = "Button",
				params = {
					image = "c_27.png",
					clickAction = "onGuessBtnAction",
					pos = {
						x = 295,
						y = 115
					},
					titleText = TR("支 持")
				},
				children = {}
			},
			{
				name = "untitled13",
				cType = "Sprite",
				params = {
					image = "txdy_4.png",
					pos = {
						x = 295.67,
						y = 355
					}
				},
				children = {}
			},
			{
				name = "mGetResLabel",
				cType = "Label",
				params = {
					fontSize = 18,
					emptyInit = true,
					isRichText = true,
					color = {
						g = 37,
						r = 37,
						b = 37
					},
					pos = {
						x = 295,
						y = 79
					},
					text = TR("支持失败也会#258711反还全部支持资金，赔率随支持人数变化而变化")
				},
				children = {}
			},
			{
				name = "mFailResLabel",
				cType = "Label",
				params = {
					fontSize = 18,
					color = {
						g = 37,
						r = 37,
						b = 37
					},
					pos = {
						x = 295,
						y = 52
					},
					text = TR("支持失败也会返还全部支持资金，赔率随支持人数变动而变化")
				},
				children = {}
			}
		}
	}
}
slot1 = {
	{
		title = TR("八强赛")
	},
	{
		title = TR("四强赛")
	},
	{
		title = TR("半决赛")
	},
	{
		title = TR("决赛")
	}
}
slot0.ctor = function (slot0, slot1)
	slot0.super.ctor(slot0)

	slot0.mPlayerLeft = slot1.playerLeft or {}
	slot0.mPlayerRight = slot1.playerRight or {}
	slot0.mTipStr = slot1.tipStr
	slot0.mCurrTurn = slot1.currTurn
	slot0.mSeverTag = slot1.severTag
	slot0.alreadyPlayerId = slot1.alreadyPlayerId
	slot0.timeStr = slot1.timeStr or ""
	slot0.mCallBack = slot1.callback

	slot0.initUI(slot0)
	slot0.refreshLayer(slot0)

	return 
end
slot0.initUI = function (slot0)
	slot0.createUITree(slot0)
	slot0.btnGuess:setEnabled(slot0.mTipStr == nil)
	slot0.btnGuess:setTitleText((slot0.mTipStr ~= nil and slot0.mTipStr) or TR("下 注"))
	slot0.mTimeLabel:setString(TR("%s下注时间: %s%s", slot0[slot0.mCurrTurn].title, "#258711", slot0.timeStr))

	return 
end
slot0.refreshLayer = function (slot0)
	if slot0.mTipStr ~= nil then
		slot0.checkBox1:setEnabled(false)
		slot0.checkBox2:setEnabled(false)
	end

	slot1(slot0.mPlayerLeft, slot0.palyerNode1, slot0.oddsLabel1, slot0.playerNameLabel1, slot0.fapLabel1, slot0.checkBox1)
	slot1(slot0.mPlayerRight, slot0.palyerNode2, slot0.oddsLabel2, slot0.playerNameLabel2, slot0.fapLabel2, slot0.checkBox2)
	slot0.resLabel:setString(string.format("{%s}%s", Resource.getDaibiImg(Utility.analysisStrResList(UniversenumoneConfig.items[1].supportNeed)[1].resourceId), Utility.analysisStrResList(UniversenumoneConfig.items[1].supportNeed)[1].num))

	return 
end
slot0.onCheckCallBack = function (slot0, slot1)
	if slot1.tag == 1 and slot0.checkBox1:isSelected() then
		slot0.checkBox2:setSelected(false)
	end

	if slot1.tag == 2 and slot0.checkBox2:isSelected() then
		slot0.checkBox1:setSelected(false)
	end

	return 
end
slot0.getHeadPicIdBySeverData = function (slot0, slot1)
	if not slot1 or slot1 == "" then
		return 0
	end

	return cjson.decode(slot1).HeadPicId or 0
end
slot0.onGuessBtnAction = function (slot0, slot1)
	slot2 = nil

	if slot0.checkBox1:isSelected() then
		slot2 = slot0.mPlayerLeft.Id
	end

	if slot0.checkBox2:isSelected() then
		slot2 = slot0.mPlayerRight.Id
	end

	if not Utility.isEntityId(slot2) then
		ui.showFlashView(TR("请选择需要支持的玩家"))

		return 
	end

	if not Resource.isEnough(Utility.analysisStrResList(UniversenumoneConfig.items[1].supportNeed)[1].resourceId, Utility.analysisStrResList(UniversenumoneConfig.items[1].supportNeed)[1].num) then
		return 
	end

	slot0.socketRequest(slot0, {
		methodName = "Bet",
		moduleName = "Universenumone",
		methodData = {
			slot0.mSeverTag,
			slot2
		},
		successCallback = function (slot0)
			ui.showFlashView(TR("支持成功！"))

			if slot0.mCallBack then
				slot0.mCallBack(slot0)
			end

			LayerManager.removeLayer(slot0)

			return 
		end
	})

	return 
end

return slot0
