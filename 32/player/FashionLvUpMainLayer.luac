slot0 = class("FashionLvUpMainLayer", require("common.BaseLayer"), function ()
	return UIWrap.newRootLayer({
		fullScreen = true
	})
end)
slot0.uiTree = {
	{
		name = "untitled117",
		cType = "Sprite",
		params = {
			isFullScale = true,
			scaleApt = 2,
			posApt = 1,
			image = "zj_123.png",
			pos = {
				x = 568,
				y = 320
			}
		},
		children = {
			{
				name = "untitled118",
				cType = "Effect",
				params = {
					dataFile = "effect_ui_shenwangchenghao_bg",
					pos = {
						x = 693,
						y = 320
					}
				},
				children = {}
			},
			{
				name = "untitled120",
				cType = "Effect",
				params = {
					dataFile = "effect_ui_shenwangchenghao_bg",
					animation = "top",
					pos = {
						x = 568,
						y = 320
					}
				},
				children = {}
			}
		}
	},
	{
		name = "centerNode",
		cType = "Node",
		params = {
			posApt = 1,
			scaleApt = 2,
			pos = {
				x = 568,
				y = 320
			}
		},
		children = {
			{
				name = "myInfoNode",
				cType = "Node",
				params = {
					pos = {
						x = 0,
						y = 0
					}
				},
				children = {}
			},
			{
				name = "untitled6",
				cType = "Scale9Sprite",
				params = {
					image = "c_9.png",
					pos = {
						x = 289.9,
						y = -0.19
					}
				},
				children = {}
			},
			{
				name = "untitled19",
				cType = "Scale9Sprite",
				params = {
					image = "jyt_30.png",
					pos = {
						x = 290.27,
						y = -127.51
					}
				},
				children = {
					{
						name = "percentLvUpLabel",
						cType = "Label",
						params = {
							isRichText = true,
							text = "Label",
							color = {
								g = 163,
								r = 103,
								b = 30
							},
							pos = {
								x = 191,
								y = -18
							}
						},
						children = {}
					},
					{
						name = "untitled116",
						cType = "ClippingNode",
						params = {
							alpha = 1,
							pos = {
								x = 26,
								y = 0
							},
							size = {
								width = 328,
								height = 12
							}
						},
						children = {
							{
								name = "expBar",
								cType = "ProgressBar",
								params = {
									maxValue = 1,
									normalImage = "jyt_31.png",
									currValue = 1,
									pos = {
										x = 164,
										y = 7
									}
								},
								children = {
									{
										name = "untitled114",
										cType = "Effect",
										params = {
											hide = true,
											childName = "lightEff",
											dataFile = "effect_ui_shengwang_jindutiao",
											pos = {
												x = 0,
												y = 7
											}
										},
										children = {}
									}
								}
							}
						}
					},
					{
						name = "untitled60",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 43.4,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled59",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 59.8,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled58",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 76.2,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled57",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 92.6,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled56",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 109,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled55",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 125.4,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled54",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 141.8,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled53",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 158.2,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled52",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 174.6,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled51",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 191,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled50",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 207.4,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled49",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 223.8,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled48",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 240.2,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled47",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 256.6,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled46",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 273,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled45",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 289.4,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled44",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 305.8,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled43",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 322.2,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "untitled42",
						cType = "Sprite",
						params = {
							image = "jyt_32.png",
							pos = {
								x = 338.6,
								y = 6.05
							}
						},
						children = {}
					},
					{
						name = "barLabel",
						cType = "Label",
						params = {
							text = "2111/5555",
							color = {
								g = 255,
								r = 255,
								b = 255
							},
							outlineColor = {
								g = 49,
								r = 49,
								b = 49
							},
							pos = {
								x = 191,
								y = 7
							}
						},
						children = {}
					}
				}
			},
			{
				name = "autoLvUpBtn",
				cType = "Button",
				params = {
					image = "c_19.png",
					clickAction = "onAutoLevelUp",
					pos = {
						x = 178.93,
						y = -228.13
					},
					titleText = TR("自动修炼")
				},
				children = {}
			},
			{
				name = "levelUpBtn",
				cType = "Button",
				params = {
					image = "c_19.png",
					clickAction = "onLevelUpOnce",
					pos = {
						x = 404.29,
						y = -227.6
					},
					titleText = TR("修炼")
				},
				children = {
					{
						name = "untitled109",
						cType = "RedDot",
						params = {
							subKey = "CanCulture",
							moduleId = 3503
						},
						children = {}
					}
				}
			},
			{
				name = "resCountLabel",
				cType = "Label",
				params = {
					isRichText = true,
					text = "Label",
					color = {
						g = 49,
						r = 49,
						b = 49
					},
					pos = {
						x = 405.16,
						y = -186.23
					}
				},
				children = {}
			},
			{
				name = "untitled94",
				cType = "Scale9Sprite",
				params = {
					image = "c_10.png",
					pos = {
						x = 290,
						y = 116.93
					},
					size = {
						width = 400,
						height = 40
					}
				},
				children = {
					{
						name = "curLvLabel",
						cType = "Label",
						params = {
							text = "Label",
							color = {
								g = 49,
								r = 49,
								b = 49
							},
							pos = {
								x = 93,
								y = 20
							}
						},
						children = {}
					},
					{
						name = "nextLvLabel",
						cType = "Label",
						params = {
							text = "Label",
							color = {
								g = 49,
								r = 49,
								b = 49
							},
							pos = {
								x = 309,
								y = 20
							}
						},
						children = {}
					}
				}
			},
			{
				name = "skillNode",
				cType = "TemplateNode",
				custom = {
					{
						value = "untitled74-text",
						name = "strLevel",
						type = "string"
					},
					{
						value = "headBtn-clickAction",
						name = "clickAction",
						type = "string"
					}
				},
				params = {
					pos = {
						x = 129,
						y = 196
					}
				},
				children = {
					{
						name = "specialBg",
						cType = "Sprite",
						params = {
							scale = 0.8,
							image = "c_25.png",
							pos = {
								x = 0,
								y = 0
							}
						},
						children = {}
					},
					{
						name = "headBtn",
						cType = "Button",
						params = {
							titleAlign = 1,
							image = "c_25.png",
							clickAction = "",
							titleValign = 1,
							titleImage = "sk_100001.png",
							scale = 0.8,
							outlineColor = {
								g = 0,
								r = 0,
								b = 0
							},
							pos = {
								x = 0,
								y = 0
							},
							titleSize = {
								width = 50,
								height = 0
							},
							titleText = TR("60级开启")
						},
						children = {}
					},
					{
						name = "levelSprite",
						cType = "Sprite",
						params = {
							image = "c_79.png",
							pos = {
								x = 2,
								y = -36
							}
						},
						children = {
							{
								name = "untitled74",
								cType = "Label",
								params = {
									fontSize = 18,
									text = "Lv.69",
									outlineColor = {
										g = 49,
										r = 49,
										b = 49
									},
									pos = {
										x = 30,
										y = 10
									}
								},
								children = {}
							}
						}
					},
					{
						name = "upSprite",
						cType = "Sprite",
						params = {
							image = "c_38.png",
							pos = {
								x = 35.35,
								y = 30.68
							}
						},
						children = {}
					}
				}
			},
			{
				name = "attrListView",
				cType = "ListView",
				params = {
					direction = true,
					swallowTouch = false,
					pos = {
						x = 87.35,
						y = -36.54
					},
					size = {
						width = 410,
						height = 130
					}
				},
				children = {
					{
						name = "attrLayout",
						cType = "Layout",
						custom = {
							{
								value = "untitled103-text",
								name = "curStr",
								type = "string"
							},
							{
								value = "untitled102-text",
								name = "nextStr",
								type = "string"
							},
							{
								value = "untitled100-hide",
								name = "hideBg",
								type = "string"
							}
						},
						params = {
							size = {
								width = 410,
								height = 40
							}
						},
						children = {
							{
								name = "untitled100",
								cType = "Scale9Sprite",
								params = {
									image = "c_10.png",
									hide = true,
									pos = {
										x = 205,
										y = 20
									},
									size = {
										width = 400,
										height = 40
									}
								},
								children = {}
							},
							{
								name = "untitled101",
								cType = "Sprite",
								params = {
									scale = 0.7,
									image = "c_23.png",
									pos = {
										x = 198,
										y = 20
									}
								},
								children = {}
							},
							{
								name = "untitled103",
								cType = "Label",
								params = {
									fontSize = 18,
									text = "Label",
									isRichText = true,
									anchor = {
										x = 0,
										y = 0.5
									},
									color = {
										g = 49,
										r = 49,
										b = 49
									},
									pos = {
										x = 12.86,
										y = 20
									}
								},
								children = {}
							},
							{
								name = "untitled102",
								cType = "Label",
								params = {
									fontSize = 18,
									text = "Label",
									isRichText = true,
									anchor = {
										x = 0,
										y = 0.5
									},
									color = {
										g = 49,
										r = 49,
										b = 49
									},
									pos = {
										x = 231,
										y = 20
									}
								},
								children = {}
							}
						}
					}
				}
			},
			{
				name = "nextTipSprite",
				cType = "Sprite",
				params = {
					scale = 0.8,
					image = "c_25.png",
					pos = {
						x = 126.84,
						y = -76.01
					}
				},
				children = {}
			},
			{
				name = "untitled11",
				cType = "Button",
				params = {
					image = "zj_26.png",
					clickAction = "onPreViewBtn",
					pos = {
						x = 462.87,
						y = -26.26
					}
				},
				children = {}
			},
			{
				name = "nextStepLabel",
				cType = "Label",
				params = {
					isRichText = true,
					anchor = {
						x = 0,
						y = 0.5
					},
					color = {
						g = 49,
						r = 49,
						b = 49
					},
					pos = {
						x = 170.29,
						y = -52.22
					},
					text = TR("洗髓到X解锁")
				},
				children = {}
			},
			{
				name = "newStepIntroLabel",
				cType = "Label",
				params = {
					fontSize = 20,
					isRichText = true,
					anchor = {
						x = 0,
						y = 1
					},
					color = {
						g = 49,
						r = 49,
						b = 49
					},
					pos = {
						x = 170.29,
						y = -67.22
					},
					size = {
						width = 320,
						height = 0
					},
					text = TR("洗髓到X解锁X解锁洗髓到X解锁洗髓到X解锁洗髓到X解锁洗髓到X解锁")
				},
				children = {}
			},
			{
				name = "untitled113",
				cType = "Scale9Sprite",
				params = {
					image = "c_11.png",
					pos = {
						x = 290.18,
						y = -27.89
					}
				},
				children = {}
			},
			{
				name = "nextFashionView",
				cType = "Scale9Sprite",
				params = {
					image = "zj_45.png",
					hide = true,
					pos = {
						x = -244.49,
						y = -256.32
					},
					size = {
						width = 440,
						height = 48
					}
				},
				children = {
					{
						name = "nextTipLabel",
						cType = "Label",
						params = {
							emptyInit = true,
							text = "Label",
							pos = {
								x = 220,
								y = 24
							}
						},
						children = {}
					}
				}
			}
		}
	},
	{
		name = "enTouchLayer",
		cType = "Layer",
		params = {
			sizeApt = 1,
			delayInit = true,
			posApt = 1,
			pos = {
				x = 0,
				y = 0
			},
			size = {
				width = 1136,
				height = 640
			}
		},
		children = {
			{
				name = "untitled107",
				cType = "Node",
				params = {
					posApt = 1,
					scaleApt = 2,
					pos = {
						x = 568,
						y = 320
					}
				},
				children = {
					{
						name = "untitled108",
						cType = "Button",
						params = {
							image = "c_19.png",
							clickAction = "onStopAutoAction",
							pos = {
								x = 179.15,
								y = -228.12
							},
							titleText = TR("停止修炼")
						},
						children = {}
					}
				}
			}
		}
	}
}
slot0.ctor = function (slot0, slot1)
	slot0.mIsAuto = false
	slot0.mNextFashionId = nil
	slot0.mNeedAction = false

	slot0.super.ctor(slot0)
	slot0.initUI(slot0)

	slot0.parent = slot1.parent

	slot0.requestGetInfo(slot0)

	return 
end
slot0.initUI = function (slot0)
	slot0.createUITree(slot0)
	slot0.showMyInfo(slot0)

	return 
end
slot0.refreshLayerUI = function (slot0, slot1)
	if slot1 then
		slot0.refreshSkillView(slot0)
	end

	slot0.refreshAttrView(slot0)

	return 
end
slot0.showMyInfo = function (slot0)
	slot1 = PlayerAttrObj:getPlayerAttrByName("FashionLevel")
	slot2 = PlayerAttrObj:getPlayerAttrByName("PlayerName")
	slot3 = PlayerAttrObj:getPlayerAttrByName("TitleId")

	if slot0.mCurTitleSprite then
		slot0.mCurTitleSprite:removeFromParent()

		slot0.mCurTitleSprite = nil
	end

	if slot0.mMyFigure then
		slot0.mMyFigure:removeFromParent()

		slot0.mMyFigure = nil
	end

	slot4 = slot0.mDefultModelId or PlayerAttrObj:getPlayerAttrByName("FashionModelId")

	if cc.FileUtils:getInstance():isFileExist(slot5 .. ".skel") then
		slot0.myInfoNode:addChild(UIWrap.newControl("Effect", {
			scale = 0.5,
			dataFile = slot5,
			pos = cc.p(-260, -230)
		}), -1)

		slot0.mMyFigure = UIWrap.newControl("Effect", {
			scale = 0.5,
			dataFile = slot5,
			pos = cc.p(-260, -230)
		})
	else
		slot0.myInfoNode:addChild(UIWrap.newControl("Sprite", {
			scale = 0.8,
			image = FashionModel.items[slot4].pic .. ".png",
			pos = cc.p(-220, 10)
		}), -1)

		slot0.mMyFigure = UIWrap.newControl("Sprite", {
			scale = 0.8,
			image = FashionModel.items[slot4].pic .. ".png",
			pos = cc.p(-220, 10)
		})
	end

	slot0.myInfoNode:addChild(UIWrap.newControl("Sprite", {
		image = "c_132.png",
		pos = cc.p(-240, -220)
	}), -2)

	return 
end
slot0.refreshSkillView = function (slot0)
	slot1 = ipairs
	slot2 = slot0.skillNodeList or {}

	for slot4, slot5 in slot1(slot2) do
		slot5.removeFromParent(slot5)

		slot5 = nil
	end

	slot0.skillNodeList = {}

	for slot5, slot6 in ipairs(slot1) do
		slot7 = slot0.createLayoutTemplateNode(slot0, "skillNode", {
			strLevel = string.format("Lv.%s", slot6.levelNum),
			clickAction = function ()
				LayerManager.addLayer({
					cleanUp = false,
					name = "player.FashionSkillLvUpLayer",
					data = {
						skillModelId = slot0.skillId,
						skillLv = slot0.levelNum,
						isActive = slot0.isActive,
						needLv = slot0.needLv,
						combatModelId = slot1.baseInfo.CombatModelId,
						skillIndex = slot2,
						callBack = function ()
							slot0:requestGetInfo()

							return 
						end
					},
					zOrder = Enums.ZOrderType.ePopLayer
				})

				return 
			end
		})

		slot7.setPosition(slot7, slot5*95 + 50, 190)
		slot0.centerNode:addChild(slot7, 1)
		table.insert(slot0.skillNodeList, slot7)
		slot7.specialBg:setVisible(false)

		slot8 = SkillModel.items[slot6.skillId].skillPic .. ".png"

		if 0 < slot0.baseInfo.CombatModelId and slot5 == 1 and FashionModel.items[slot0.baseInfo.CombatModelId] then
			slot7.specialBg:setVisible(true)
		end

		dump(slot8, slot5)
		slot7.headBtn:setTitleImage(slot8)
		slot7.upSprite:setPosition(cc.p(35, 30.5))
		slot7.upSprite:stopAllActions()
		slot7.upSprite:setVisible(false)

		if not slot6.isActive then
			slot7.headBtn.titleSprite:setGray(true)
			slot7.headBtn:setTitleText(TR("%s阶解锁", slot6.needLv))
			slot7.levelSprite:setVisible(false)
		else
			slot7.headBtn:setTitleText("")
			slot7.levelSprite:setVisible(true)

			if FashionSkillConfig.items[slot6.skillNum][slot6.levelNum].lvUpNeed ~= "" then
				if Resource.isEnough(Utility.analysisStrResList(slot9)[1].resourceId, Utility.analysisStrResList(slot9)[1].num, false) then
					slot7.upSprite:setVisible(true)
					slot7.upSprite:runAction(cc.RepeatForever:create(cc.Sequence:create(cc.JumpBy:create(1, cc.p(0, 0), 5, 2), cc.DelayTime:create(2))))
				end
			else
				slot7.upSprite:setVisible(false)
			end
		end
	end

	return 
end
slot0.getFashionSkillData = function (slot0)
	slot1 = {}
	slot3 = FashionModel.items[slot0.baseInfo.CombatModelId]

	for slot7, slot8 in ipairs(FashionSkillConfig.items) do
		slot1[slot7] = {
			skillNum = slot8[1].skillNum,
			needLv = slot8[1].needLv,
			skillId = slot3[TR("skill%s", slot7)]
		}
	end

	for slot7, slot8 in ipairs(slot1) do
		slot9 = false
		slot10 = 1

		if slot0.skillList[slot7] then
			slot10 = slot11.Level
			slot9 = true
		end

		slot8.isActive = slot9
		slot8.levelNum = slot10
	end

	return slot1
end
slot0.refreshAttrView = function (slot0)
	slot0.attrListView:removeAllChildren()

	slot2 = FashionLvupConfig.items[slot0.curLevel + 1] or {}
	slot3 = true
	slot4 = math.floor(slot0.baseInfo.Exp/FashionLvupConfig.items[slot0.curLevel].needExp/20)
	slot5 = {}
	slot6 = {}
	slot5 = slot0.getAttrStrList(slot0, slot0.curLevel, true)

	if next(slot2) then
		slot6 = slot0.getAttrStrList(slot0, slot0.curLevel + 1)
		slot3 = false
	end

	if slot3 then
		slot6 = {
			TR("已修炼至满级")
		}

		slot0.levelUpBtn:setEnabled(false)
		slot0.autoLvUpBtn:setEnabled(false)
	end

	slot7 = (#slot6 <= #slot5 and #slot5) or #slot6

	for slot11 = 1, slot7, 1 do
		slot0.attrListView:pushBackCustomItem(slot0.createLayoutTemplateNode(slot0, "attrLayout", {
			curStr = slot5[slot11] or "",
			nextStr = slot6[slot11] or "",
			hideBg = slot11%2 ~= 0
		}))
	end

	slot9 = (slot3 and Utility.getPlayerNameColor(slot0.curLevel, true)) or Utility.getPlayerNameColor(slot0.curLevel + 1, true)

	slot0.curLvLabel:setString(TR("当前等级：%d阶", slot0.curLevel))
	slot0.nextLvLabel:setString((slot3 and TR("下一等级：无")) or TR("下一等级：%d阶", slot0.curLevel + 1))

	if not slot3 then
		slot10 = 0
		slot11 = ""
		slot12 = ""

		for slot16 = slot0.curLevel + 1, FashionLvupConfig.items_count, 1 do
			if FashionLvupConfig.items[slot16].skillIntro ~= "" then
				slot11 = slot17.skillIntro
				slot10 = slot17.Lv
				slot12 = slot17.skillPic

				break
			end
		end

		slot0.nextStepLabel:setString(TR("修炼到#DF0A0A%s#313131阶解锁", slot10))
		slot0.newStepIntroLabel:setString(slot11)

		if slot12 ~= "" then
			slot0.nextTipSprite:setVisible(true)
			slot0.nextTipSprite:setTexture(slot12 .. ".png")
		end
	else
		slot0.nextStepLabel:setVisible(false)
		slot0.nextTipSprite:setVisible(false)
		slot0.nextFashionView:setVisible(false)
		slot0.newStepIntroLabel:setString(TR("主角修炼等级已达到上限"))
	end

	if slot1.strNeed ~= "" then
		slot10 = Utility.analysisStrResList(slot1.strNeed)

		slot0.resCountLabel:setString(TR("{%s}%s%s#313131/%s", Resource.getDaibiImg(slot10[1].resourceId), (slot10[1].num <= Resource.getCount(slot10[1].resourceId) and "#67A31E") or "#DF0A0A", slot12, slot10[1].num))

		slot0.costInfo = slot10
	end

	if slot3 then
		slot0.percentLvUpLabel:setVisible(false)
	else
		slot10 = ""

		for slot14, slot15 in pairs(FashionLvupRelation.items[slot0.curLevel]) do
			if slot15.expMin <= slot0.baseInfo.Exp and slot0.baseInfo.Exp <= slot15.expMax then
				slot10 = slot15.showOdds

				break
			end
		end

		slot0.percentLvUpLabel:setString(TR("%s#313131概率直接升级", slot10))
		slot0.percentLvUpLabel:setVisible(slot10 ~= "")
	end

	slot0.progressBarAction(slot0)
	slot0.barLabel:setString(string.format("%s/%s", slot0.baseInfo.Exp, FashionLvupConfig.items[slot0.curLevel].needExp))

	return 
end
slot0.getAttrStrList = function (slot0, slot1, slot2)
	slot5 = Utility.analysisStrAttrList(FashionLvupConfig.items[slot1].addAttrStr)
	slot6 = {}

	for slot10, slot11 in ipairs(slot4) do
		if not slot6[slot11.fightattr] then
			slot6[slot11.fightattr] = {
				order = slot10,
				attr = slot11.fightattr,
				value = slot11.value
			}
		end
	end

	slot7 = 0

	for slot11, slot12 in pairs(slot6) do
		slot7 = slot7 + 1
	end

	if slot2 then
		slot9 = math.floor(slot0.baseInfo.Exp/slot3.needExp/20)

		for slot13, slot14 in ipairs(slot5) do
			if not slot6[slot14.fightattr] then
				slot6[slot14.fightattr] = {
					order = slot7 + slot13,
					attr = slot14.fightattr,
					value = slot14.value*slot9
				}
			else
				slot6[slot14.fightattr].value = slot6[slot14.fightattr].value + slot14.value*slot9
			end
		end
	end

	slot8 = {}

	for slot12, slot13 in pairs(slot6) do
		table.insert(slot8, slot13)
	end

	table.sort(slot8, function (slot0, slot1)
		return slot0.order < slot1.order
	end)

	slot9 = {}

	for slot13, slot14 in ipairs(slot8) do
		slot15 = nil

		table.insert(slot9, (Utility.isAttrNeedPercent(slot14.attr) and ((slot2 or TR("全体%s#386d00+", FightAttrTypeName[slot14.attr])) and TR("全体%s+", FightAttrTypeName[slot14.attr])) .. slot14.value/100 .. "%") or ((slot2 or TR("全体%s#386d00+", FightAttrTypeName[slot14.attr])) and TR("全体%s+", FightAttrTypeName[slot14.attr])) .. slot14.value)
	end

	return slot9
end
slot0.progressBarAction = function (slot0)
	slot1 = (slot0.mIsAuto and 0.3) or 0.3
	slot2 = slot0.expBar:getContentSize()

	function slot3(slot0, slot1)
		return cc.Sequence:create(cc.MoveTo:create(slot1, cc.p(slot0, 5)), cc.CallFunc:create(function ()
			slot0.expBar.lightEff:setVisible(false)

			slot0.expBar.lightEff.setVisible.mNeedAction = false

			return 
		end))
	end

	if slot0.mIsLevelUp then
		slot0.expBar:setMaxValue(FashionLvupConfig.items[slot0.curLevel - 1].needExp)
		slot0.expBar:setCurrValue(FashionLvupConfig.items[slot0.curLevel - 1].needExp, slot1, function ()
			slot0.mIsLevelUp = false

			slot0.expBar:setMaxValue(FashionLvupConfig.items[slot0.curLevel].needExp)
			slot0.expBar.setMaxValue:showLvUpLayer()
			slot0.expBar.setMaxValue.showLvUpLayer.expBar:setCurrValue(slot0.baseInfo.Exp, 0.1, function ()
				slot0.levelUpBtn:setEnabled(true)

				slot0.levelUpBtn.setEnabled.mIsAuto = false

				slot0.levelUpBtn.setEnabled:onStopAutoAction()

				return 
			end)
			slot0.expBar.setMaxValue.showLvUpLayer.expBar.setCurrValue.expBar.lightEff:setVisible(true)
			slot0.expBar.lightEff:runAction(slot0.expBar.lightEff(slot0.expBar.setMaxValue.showLvUpLayer.expBar.setCurrValue.expBar.lightEff.setVisible.baseInfo.Exp/FashionLvupConfig.items[slot0.curLevel].needExp*FashionLvupConfig.items[slot0.curLevel].needExp.width, 0.1))

			return 
		end)

		if slot0.mNeedAction then
			slot0.expBar.lightEff:setVisible(true)
			slot0.expBar.lightEff:runAction(slot3(slot2.width, slot1))
		end
	else
		slot0.expBar:setMaxValue(FashionLvupConfig.items[slot0.curLevel].needExp)
		slot0.expBar:setCurrValue(slot0.baseInfo.Exp, slot1, function ()
			slot0.levelUpBtn:setEnabled(true)

			if slot0.levelUpBtn.setEnabled.mIsAuto then
				slot0:requestCulture()
			end

			return 
		end)

		if slot0.mNeedAction then
			slot0.expBar.lightEff:setVisible(true)
			slot0.expBar.lightEff:runAction(slot3(slot0.baseInfo.Exp/FashionLvupConfig.items[slot0.curLevel].needExp*slot2.width, slot1))
		end
	end

	if slot0.isFullLv(slot0) then
		slot0.expBar:setMaxValue(1)
		slot0.expBar:setCurrValue(1)
		slot0.barLabel:setVisible(false)
	end

	return 
end
slot0.onLevelUpOnce = function (slot0, slot1)
	if slot0.isFullLv(slot0) then
		ui.showFlashView(TR("已修炼至满级"))

		return 
	end

	slot1.setEnabled(slot1, false)
	slot0.requestCulture(slot0)

	return 
end
slot0.isFullLv = function (slot0)
	slot1 = false

	if not FashionLvupConfig.items[slot0.curLevel + 1] then
		slot1 = true
	end

	return slot1
end
slot0.onAutoLevelUp = function (slot0)
	if slot0.isFullLv(slot0) then
		return 
	end

	slot0.mIsAuto = true

	slot0.createUISubTree(slot0, "enTouchLayer")
	ui.addTouchEvent({
		swallowTouch = true,
		node = slot0.enTouchLayer
	})
	slot0.requestCulture(slot0)

	return 
end
slot0.onStopAutoAction = function (slot0)
	if slot0.enTouchLayer then
		slot0.enTouchLayer:removeFromParent()

		slot0.enTouchLayer = nil
	end

	slot0.mIsAuto = false

	return 
end
slot0.onPreViewBtn = function (slot0)
	LayerManager.addLayer({
		cleanUp = false,
		name = "player.FashionPreviewLayer",
		data = {
			curLv = slot0.curLevel
		},
		zOrder = Enums.ZOrderType.ePopLayer
	})

	return 
end
slot0.showLvUpLayer = function (slot0)
	LayerManager.addLayer({
		cleanUp = false,
		name = "player.FashionStepUpLayer",
		data = {
			curLv = slot0.curLevel
		},
		zOrder = Enums.ZOrderType.ePopLayer
	})

	return 
end
slot0.showNextFashion = function (slot0)
	slot1 = FashionLvupConfig.items[slot0.curLevel].lvModelId
	slot2 = 0
	slot3 = 0

	for slot7 = slot0.curLevel + 1, FashionLvupConfig.items_count, 1 do
		if FashionLvupConfig.items[slot7] and slot8.lvModelId ~= slot1 then
			slot2 = slot8.Lv
			slot3 = slot8.lvModelId

			break
		end
	end

	if slot0.mNextFashionId and slot0.mNextFashionId == slot3 then
		return 
	end

	slot0.mNextFashionId = slot3

	if slot3 ~= 0 then
		if slot0.nextFashionView.nextFigure then
			slot0.nextFashionView.nextFigure:removeFromParent()

			slot0.nextFashionView.nextFigure = nil
		end

		slot0.nextTipLabel:setString(TR("%s阶解锁新形象", slot2))
		slot0.nextFashionView:setVisible(true)

		if cc.FileUtils:getInstance():isFileExist(slot4 .. ".skel") then
			slot0.nextFashionView:addChild(UIWrap.newControl("Effect", {
				scale = 0.5,
				dataFile = slot4,
				pos = cc.p(200, 20)
			}), -1)

			slot0.nextFashionView.nextFigure = UIWrap.newControl("Effect", {
				scale = 0.5,
				dataFile = slot4,
				pos = cc.p(200, 20)
			})
		else
			slot0.nextFashionView:addChild(UIWrap.newControl("Sprite", {
				scale = 0.8,
				image = FashionModel.items[slot3].pic .. ".png",
				pos = cc.p(240, 260)
			}), -1)

			slot0.nextFashionView.nextFigure = UIWrap.newControl("Sprite", {
				scale = 0.8,
				image = FashionModel.items[slot3].pic .. ".png",
				pos = cc.p(240, 260)
			})
		end
	else
		slot0.nextTipLabel:setString(TR("已解锁全部形象"))

		if slot0.nextFashionView.nextFigure then
			slot0.nextFashionView.nextFigure:removeFromParent()

			slot0.nextFashionView.nextFigure = nil
		end

		if cc.FileUtils:getInstance():isFileExist(slot4 .. ".skel") then
			slot0.nextFashionView:addChild(UIWrap.newControl("Effect", {
				scale = 0.5,
				dataFile = slot4,
				pos = cc.p(200, 20)
			}), -1)

			slot0.nextFashionView.nextFigure = UIWrap.newControl("Effect", {
				scale = 0.5,
				dataFile = slot4,
				pos = cc.p(200, 20)
			})
		else
			slot0.nextFashionView:addChild(UIWrap.newControl("Sprite", {
				scale = 0.8,
				image = FashionModel.items[slot1].pic .. ".png",
				pos = cc.p(240, 260)
			}), -1)

			slot0.nextFashionView.nextFigure = UIWrap.newControl("Sprite", {
				scale = 0.8,
				image = FashionModel.items[slot1].pic .. ".png",
				pos = cc.p(240, 260)
			})
		end
	end

	return 
end
slot0.requestGetInfo = function (slot0)
	slot0.socketRequest(slot0, {
		methodName = "GetInfo",
		moduleName = "Fashion",
		methodData = {},
		successCallback = function (slot0)
			dump(slot0, "GetInfo")

			slot0.baseInfo = slot0.BaseInfo or {}
			slot0.skillList = slot0.SkillList or {}
			slot1 = {}
			slot2 = ipairs
			slot3 = slot0.SkillList or {}

			for slot5, slot6 in slot2(slot3) do
				slot1[tostring(slot6.Id)] = slot6.Level
			end

			PlayerAttrObj:changeAttr({
				FashionSkills = slot1
			})

			slot0.curLevel = slot0.baseInfo.Level or 0

			slot0:refreshLayerUI(true)
			slot0:executeGuide()

			return 
		end
	})

	return 
end
slot0.requestCulture = function (slot0)
	if not Resource.isEnough(slot0.costInfo[1].resourceId, slot0.costInfo[1].num, false) then
		LayerManager.setRestoreData("player.PlayerMainLayer", {
			defaultModuleId = ModuleSub.eTreasure
		})
		LayerManager.addLayer({
			cleanUp = false,
			name = "commonlayer.GoodsGetWaysLayer",
			data = {
				resourceId = slot0.costInfo[1].resourceId
			},
			zOrder = Enums.ZOrderType.ePopLayer
		})
		slot0.levelUpBtn:setEnabled(true)
		slot0.onStopAutoAction(slot0)

		return 
	end

	slot0.socketRequest(slot0, {
		methodName = "Culture",
		moduleName = "Fashion",
		methodData = {},
		guideInfo = Guide.manager:getCurRequestGuideData(),
		successCallback = function (slot0)
			slot0.skillList = slot0.SkillList or slot0.skillList
			slot0.baseInfo = slot0.BaseInfo

			if slot0.curLevel < slot0.BaseInfo.Level then
				slot0.curLevel = slot0.BaseInfo.Level

				PlayerAttrObj:changeAttr({
					FashionLevel = slot0.BaseInfo.Level
				})

				slot0.isAuto = false

				slot0:onStopAutoAction()

				slot0.mIsLevelUp = true

				slot0:showMyInfo()
			end

			slot0.mNeedAction = true

			slot0:refreshLayerUI(slot0.mIsLevelUp)
			MqAudio.playEffect("shengwangjindutiao.mp3")

			return 
		end,
		failedCallback = function ()
			slot0.levelUpBtn:setEnabled(true)
			slot0.levelUpBtn.setEnabled:onStopAutoAction()

			return 
		end
	})

	return 
end
slot0.executeGuide = function (slot0)
	Guide.manager:exeGuideList({
		[201003] = {
			clickNode = slot0.levelUpBtn
		},
		[201004] = {},
		[201005] = {
			clickNode = slot0.parent.closeBtn
		}
	})

	return 
end

return slot0
