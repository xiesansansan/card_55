slot0 = class("DrumBuyLayer", require("common.BaseLayer"), function ()
	return UIWrap.newRootLayer({
		fullScreen = true
	})
end)
slot0.uiTree = {
	{
		name = "untitled1",
		cType = "Sprite",
		params = {
			isFullScale = true,
			scaleApt = 2,
			posApt = 1,
			image = "cz_21.png",
			pos = {
				x = 568,
				y = 320
			}
		},
		children = {}
	},
	{
		name = "centerNode",
		cType = "Node",
		params = {
			posApt = 1,
			scaleApt = 2,
			pos = {
				x = 568,
				y = 320
			}
		},
		children = {
			{
				name = "untitled23",
				cType = "Sprite",
				params = {
					image = "cz_58.png",
					pos = {
						x = 51.18,
						y = 13.25
					}
				},
				children = {}
			},
			{
				name = "untitled8",
				cType = "Sprite",
				params = {
					image = "cz_51.png",
					pos = {
						x = -49.26,
						y = 12.92
					}
				},
				children = {
					{
						name = "untitled19",
						cType = "ClippingNode",
						params = {
							alpha = 1,
							pos = {
								x = 14.88,
								y = 1.51
							},
							size = {
								width = 850.6,
								height = 347.95
							}
						},
						children = {
							{
								name = "drumEff",
								cType = "Effect",
								params = {
									dataFile = "effect_ui_tulongdao",
									scale = 0.5,
									animation = "tielian",
									pos = {
										x = 358.05,
										y = 169.85
									}
								},
								children = {}
							}
						}
					}
				}
			},
			{
				name = "untitled2",
				cType = "Sprite",
				params = {
					image = "cz_32.png",
					pos = {
						x = -49.56,
						y = 180.25
					}
				},
				children = {}
			},
			{
				name = "untitled5",
				cType = "Sprite",
				params = {
					image = "c_36.png",
					pos = {
						x = -200.85,
						y = 181.95
					}
				},
				children = {}
			},
			{
				name = "untitled3",
				cType = "Sprite",
				params = {
					reverse = 1,
					image = "c_36.png",
					pos = {
						x = 103,
						y = 181.95
					}
				},
				children = {}
			},
			{
				name = "starNode",
				cType = "StarNode",
				params = {
					exStarImg = "c_89.png",
					starLevel = 4,
					exStarLevel = 9,
					starImg = "c_5.png",
					pos = {
						x = -48.7,
						y = 145.63
					}
				},
				children = {}
			},
			{
				name = "untitled17",
				cType = "Scale9Sprite",
				params = {
					image = "cz_59.png",
					pos = {
						x = 401.02,
						y = 84.16
					}
				},
				children = {}
			},
			{
				name = "buyBtn",
				cType = "Button",
				params = {
					image = "cz_63.png",
					clickAction = "onBuyBtn",
					titleImage = "cz_64.png",
					pos = {
						x = 400.39,
						y = -140.87
					}
				},
				children = {
					{
						name = "untitled31",
						cType = "RedDot",
						params = {
							subKey = "IfStarUp",
							moduleId = 3001,
							offset = {
								x = 0.9,
								y = 0.7
							}
						},
						children = {}
					}
				}
			},
			{
				name = "introLabel",
				cType = "Label",
				params = {
					fontSize = 20,
					isRichText = true,
					anchor = {
						x = 0,
						y = 0.5
					},
					color = {
						g = 37,
						r = 37,
						b = 37
					},
					pos = {
						x = 324.07,
						y = 56.09
					},
					text = TR("修复")
				},
				children = {}
			},
			{
				name = "untitled29",
				cType = "Label",
				params = {
					fontSize = 20,
					isRichText = true,
					anchor = {
						x = 0,
						y = 0.5
					},
					color = {
						g = 37,
						r = 37,
						b = 37
					},
					pos = {
						x = 324.07,
						y = 25.09
					},
					text = TR("即可获得：")
				},
				children = {}
			},
			{
				name = "untitled28",
				cType = "Label",
				params = {
					fontSize = 20,
					isRichText = true,
					anchor = {
						x = 0,
						y = 0.5
					},
					color = {
						g = 37,
						r = 37,
						b = 37
					},
					pos = {
						x = 322.07,
						y = -0.91
					},
					text = TR("大量属性提升!!!")
				},
				children = {}
			},
			{
				name = "untitled25",
				cType = "Sprite",
				params = {
					image = "cz_60.png",
					pos = {
						x = 398.62,
						y = 99.39
					}
				},
				children = {
					{
						name = "untitled26",
						cType = "Label",
						params = {
							color = {
								g = 240,
								r = 251,
								b = 238
							},
							pos = {
								x = 83.66,
								y = 38.01
							},
							text = TR("永久加成")
						},
						children = {}
					}
				}
			},
			{
				name = "untitled14",
				cType = "Scale9Sprite",
				params = {
					image = "cz_33.png",
					hide = true,
					pos = {
						x = 391.19,
						y = 254.54
					}
				},
				children = {
					{
						name = "untitled15",
						cType = "Label",
						params = {
							fontSize = 18,
							color = {
								g = 37,
								r = 37,
								b = 37
							},
							pos = {
								x = 120,
								y = 10
							},
							text = TR("*屠龙宝刀不参与任何充值活动")
						},
						children = {}
					}
				}
			},
			{
				name = "untitled27",
				cType = "Sprite",
				params = {
					image = "cz_61.png",
					pos = {
						x = 421.53,
						y = 55.96
					}
				},
				children = {}
			},
			{
				name = "untitled11",
				cType = "Label",
				params = {
					color = {
						g = 37,
						r = 37,
						b = 37
					},
					pos = {
						x = 401.17,
						y = 196.13
					},
					text = TR("搜集材料修复")
				},
				children = {}
			},
			{
				name = "untitled34",
				cType = "Button",
				params = {
					image = "c_pure.png",
					pos = {
						x = 402,
						y = 159.85
					},
					size = {
						width = 125.81,
						height = 39.88
					}
				},
				children = {
					{
						name = "untitled35",
						cType = "Label",
						params = {
							color = {
								g = 199,
								r = 223,
								b = 42
							},
							outlineColor = {
								g = 37,
								r = 37,
								b = 37
							},
							pos = {
								x = 5.77,
								y = 0.32
							},
							text = TR("前往》")
						},
						children = {}
					}
				}
			}
		}
	}
}
slot0.ctor = function (slot0, slot1)
	slot0.super.ctor(slot0)

	slot0.mDrumModelId = PlayerDrumModel.items[1].modelId

	dump(slot3, "IOHCH")

	for slot7, slot8 in pairs(slot3) do
		if slot8.ModelId == slot2 then
			slot0.mStarLv = slot8.StarLv
		end
	end

	slot0.initUI(slot0)
	EventAuto:registerAutoEvent(slot0, EventDefine.eRechargeType .. Enums.chargeType.eTulong, function ()
		ui.showFlashView(TR("购买成功"))

		ui.showFlashView.mStarLv = 0

		table.insert(slot0, {
			StarLv = 0,
			ModelId = slot0.mDrumModelId
		})
		PlayerAttrObj:changeAttr({
			DrumInfo = {}
		})
		slot0:refreshUI()
		MqAudio.playEffect("tulongdaojihuo.mp3")
		slot0.drumEff:playAnimation("jihuo", 1)
		slot0.drumEff:registerLuaHandler("complete", function (slot0)
			if slot0.animation == "jihuo" then
				slot0.drumEff:playAnimation("xunhuan2", nil)
			end

			return 
		end)

		return 
	end)

	if RedDotObj:isValid(ModuleSub.ePlayerDrumPoint) then
		RedDotObj:seeRedDot("PlayerDrumDefault")
	end

	return 
end
slot0.initUI = function (slot0)
	slot0.createUITree(slot0)
	slot0.refreshUI(slot0)

	return 
end
slot0.refreshUI = function (slot0)
	slot2 = Utility.analysisStrResList(PlayerDrumModel.items[1].buyReward)

	if slot0.mStarLv then
		slot0.buyBtn:setTitleImage("cz_65.png")
		slot0.starNode:setStarLevel(slot0.mStarLv, 12)
		slot0.drumEff:playAnimation("xunhuan2", nil)
	else
		slot0.starNode:setStarLevel(0, 9)
	end

	return 
end
slot0.onBuyBtn = function (slot0)
	if slot0.mStarLv then
		LayerManager.addLayer({
			cleanUp = false,
			name = "player.DrumLvUpLayer",
			data = {
				callBack = function (slot0)
					slot0.mStarLv = slot0

					slot0:refreshUI()

					return 
				end
			},
			zOrder = Enums.ZOrderType.ePopLayer
		})
	end

	return 
end
slot0.onGoBtn = function (slot0)
	LayerManager.showModuleLayer(ModuleSub.eAuction)

	return 
end
slot0.requestGetProductInfo = function (slot0)
	slot0.socketRequest(slot0, {
		methodName = "GetProductInfo",
		moduleName = "Drum",
		methodData = {},
		successCallback = function (slot0)
			dump(slot0, "iiiii")

			slot1, slot2 = nil

			for slot6, slot7 in pairs(slot0) do
				if slot7.ModelId == slot0.mDrumModelId then
					slot1 = slot7.ProductId
					slot2 = slot7.OpenBuyPrice

					break
				end
			end

			Utility.recharge({
				chargeType = Enums.chargeType.eTulong,
				price = slot2,
				productId = slot1
			}, function ()
				return 
			end)

			return 
		end
	})

	return 
end

return slot0
